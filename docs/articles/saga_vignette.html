<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SAGA • saga</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="SAGA">
<meta property="og:description" content="">
<meta property="og:image" content="/logo.png">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">saga</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/saga_vignette.html">SAGA</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/mytalbot/saga_package">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>SAGA</h1>
                        <h4 class="author">Steven R. Talbot</h4>
            
            <h4 class="date">2020-01-13</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/mytalbot/saga_package/blob/master/vignettes/saga_vignette.Rmd"><code>vignettes/saga_vignette.Rmd</code></a></small>
      <div class="hidden name"><code>saga_vignette.Rmd</code></div>

    </div>

    
    
<div id="about-saga-package" class="section level2">
<h2 class="hasAnchor">
<a href="#about-saga-package" class="anchor"></a>About SAGA package</h2>
<p>In our paper <strong>“Predicting genotoxicity of integrating viral vectors for stem cell gene therapy using gene expression-based machine learning”</strong> we report an improved in vitro test to determine the risk of insertional mutagenesis of integrating vectors for gene therapy. SAGA builds on the well accepted cell culture protocol of the in vitro immortalization assay (IVIM) but screens for the deregulation of oncogenic gene expression signatures. We demonstrate a new bioinformatic apporach to correctly classify the mutagenic potential of retroviral vectors used in previous and current clinical trials.</p>
<p>This vignette covers the basic functions for SAGA analysis in R [1].</p>
</div>
<div id="package-requirements" class="section level1">
<h1 class="hasAnchor">
<a href="#package-requirements" class="anchor"></a>Package Requirements</h1>
<p>In order to use the SAGA package some Bioconductor dependencies need to be installed. First, the connection to the Bioconductor database must be established. Then the required packages can be loaded independently. Please note that these packages are only available over Bioconductor and cannot be loaded using CRAN.</p>
<p><a href="https://cran.r-project.org/web/packages/BiocManager/vignettes/BiocManager.html">BiocManager</a></p>
<pre><code>install.packages("BiocManager")

BiocManager::install("Biobase") 
BiocManager::install("BiocGenerics") 
BiocManager::install("affy") 
BiocManager::install("affyPLM") 
BiocManager::install("phenoTest")
</code></pre>
<p>The <a href="#references">reference section</a> offers more information on the packages Biobase [2], BioGenerics [2], affy [3], affyPLM [4] and phenoTest [5].</p>
<p>The following packages (with dependencies) need to be loaded as well. They can be installed via CRAN. The following links can be used directly in the R console.</p>
<pre><code>install.packages("limma") 
install.packages("sva")
install.packages("caret")
install.packages("phenoTest")
install.packages("gridExtra")
install.packages("bapred")
install.packages("UsingR")
install.packages("pROC")
install.packages("Rtsne")
</code></pre>
<p>Again, the <a href="#references">reference section</a> offers more information on the packages limma [6], sva [7], caret [8], phenoTest [9], gridExtra [10], bapred [11], UsingR [12], pROC [13] and Rtsne [14-16].</p>
<div id="saga-package-installation" class="section level2">
<h2 class="hasAnchor">
<a href="#saga-package-installation" class="anchor"></a>SAGA Package installation</h2>
<p>SAGA can be downloaded from Github using the following commands:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># install.packages("devtools")</span>
devtools<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/devtools/topics/reexports">install_github</a></span>(<span class="st">"mytalbot/saga_package"</span>)
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(saga)</code></pre></div>
<p>Further, the sagadata for SAGA core data need to loaded in a separate package because it is too large to fit in the saga package. sagadata can be obtained from GitHub as well:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">devtools<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/devtools/topics/reexports">install_github</a></span>(<span class="st">"mytalbot/sagadata"</span>)
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(sagadata)</code></pre></div>
<p>For more information on SAGA, visit the <a href="https://talbotsr.com/saga_package/index.html">website</a>.</p>
</div>
</div>
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p><code>SAGA</code> analysis starts with raw data obtained from regular gene expression microarray analysis acquired by Agilent platforms. This is important since the functions in this package will only work within the Agilent format. In the current version other platforms were not specifically included into the capacities of this package. If you wish to use other platforms you’ll have to adapt the functions to your specific needs.</p>
<p>As described in the paper, we optimized a training set of arrays to discriminate between potentially dangerous arrays and MOCK data in order to obtain a measurement for vector safety. Vector safety is therefore described as either <em>transforming</em> or <em>nontransforming</em> in the package.</p>
<p>The basic SAGA classifier was obtained by varius Machine Learning algorithms as well as feature assessment techniques as described in our paper. In essence, a toplist of 9 probes were obtained that are able to predict untrained samples reliably well. The <code>SAGA</code> package uses its default data set and the probe toplist to predict user sample data.</p>
<p>Although the arrays provide 39428 probes the annotations were (<strong>de novo</strong>) remapped to the latest available standard (Gencode.vM18, GRCm38.p6, released July 2018 and Whole Mouse Genome Oligo Microarray 4x44K v2 (ID 026655, released October 2017)), so that only 36226 annotated probes were considered in the final model building process.</p>
<p>Further, the user may specify his/her own positive and negative controls for more confidence in the predicted results.</p>
</div>
<div id="basic-requirements" class="section level1">
<h1 class="hasAnchor">
<a href="#basic-requirements" class="anchor"></a>Basic requirements</h1>
<p>In order to use the <code>SAGA</code> package the user has to create a specific folder with sample data. The samples must follow the Agilent design and must be in *.txt format. Sample names should be numeric.</p>
<p>Possible sample names would be: 9910.txt, 9911.txt, 9912.txt etc.</p>
<p>Further, a <strong>‘SampleInformation.txt’</strong> or targets file is needed. This file consists of a table with certain columns which are later used to merge the user data with the default data. In the shown plots user data will always be colored black for identification purposes.</p>
<p>It is important to know, that the targets file <span style="color:red"><strong>has</strong></span> to have the following name: <strong>SampleInformation.txt</strong> and also <span style="color:red"><strong>has</strong></span> to be located in the same folder as the samples.</p>
<p>The user may change the contents of this file manually to adjust his batch, group, vector or class settings.</p>
<p><code>SAGA</code> offers a function to generate a blank SampleInformation.txt file automatically. However, this only works if there is no such file in the sample directory. Otherwise the already provided file will be used. The generated targets file may then be adjusted manually. Make sure not to hamper with the column names. Column names are case sensitive.</p>
</div>
<div id="data-structure" class="section level1">
<h1 class="hasAnchor">
<a href="#data-structure" class="anchor"></a>Data structure</h1>
<p>Here is a short example of a minimal targets file in txt-format. The first column must contain the array names. You may specify the names by yourself or let your microarray platform choose the labelling. However, it is best that the names do not contain any special characters such as <em>“§%&amp;-”</em> and that they are numeric (and in an ascending order).</p>
<p>Make sure that the targets file has the following format.</p>
<table class="table">
<caption>Example of a SampleInformation.txt file.</caption>
<thead><tr class="header">
<th align="left">SAMPLE_ID</th>
<th align="left">Filename</th>
<th align="left">Batch</th>
<th align="left">Group</th>
<th align="left">Vector</th>
<th align="left">TrueLabel</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">X41</td>
<td align="left">41.txt</td>
<td align="left">1</td>
<td align="left">1</td>
<td align="left">A2_MOCK</td>
<td align="left">nontransforming</td>
</tr>
<tr class="even">
<td align="left">X42</td>
<td align="left">42.txt</td>
<td align="left">1</td>
<td align="left">2</td>
<td align="left">A9_SIN.AV.EFS</td>
<td align="left">transforming</td>
</tr>
<tr class="odd">
<td align="left">X43</td>
<td align="left">43.txt</td>
<td align="left">1</td>
<td align="left">3</td>
<td align="left">A1_LTR.RV.SF.eGFP</td>
<td align="left">transforming</td>
</tr>
<tr class="even">
<td align="left">X44</td>
<td align="left">44.txt</td>
<td align="left">1</td>
<td align="left">4</td>
<td align="left">A9_SIN.AV.EFS</td>
<td align="left">transforming</td>
</tr>
<tr class="odd">
<td align="left">X45</td>
<td align="left">45.txt</td>
<td align="left">1</td>
<td align="left">5</td>
<td align="left">A10_SIN.AV.SF</td>
<td align="left">transforming</td>
</tr>
<tr class="even">
<td align="left">X46</td>
<td align="left">46.txt</td>
<td align="left">1</td>
<td align="left">6</td>
<td align="left">A9_SIN.AV.EFS</td>
<td align="left">transforming</td>
</tr>
<tr class="odd">
<td align="left">…</td>
<td align="left">…</td>
<td align="left">…</td>
<td align="left">…</td>
<td align="left">…</td>
<td align="left">…</td>
</tr>
</tbody>
</table>
<p>In the table, the first array (41.txt) is labelled as <em>nontransforming</em> in the <strong>TrueLabel</strong> column. Using either <strong>nontransforming</strong> or <strong>transforming</strong> as class labels, the user may specify his own positive or negative controls. When left empty (NA) the arrays will be classified against the default model.</p>
<p>We recommend that users include at least 2 to 3 MOCK (negative) and RV.SF (positive) controls in their own models. The batch correction algorithm may need this for proper integration of the provided data into the SAGA data set.</p>
<p><strong>IMPORTANT for GESEA:</strong> For the Gene Set Enrichment Analysis (GESEA) the user must provide at least 3 samples in two different batches. One of the three samples must be a MOCK control (vector) and labelled as 1 in the Group column. Every MOCK control needs the Group label 1. All other arrays may have other numeric labels.</p>
</div>
<div id="using-the-functions-of-the-saga-package" class="section level1">
<h1 class="hasAnchor">
<a href="#using-the-functions-of-the-saga-package" class="anchor"></a>Using the functions of the SAGA package</h1>
<p>The following section explains the functions of this package and how to use them in SAGA analysis.</p>
<div id="saga_gentargets" class="section level2">
<h2 class="hasAnchor">
<a href="#saga_gentargets" class="anchor"></a>saga_gentargets</h2>
<p>After pooling the samples in a specific folder (<code>samplepath</code>), a targets file called <code>SampleInformation.txt</code> must be provided for analysis. Without this file SAGA analysis will fail. Since its construction is a bit tedious we provide a function for automatic generation of an empty file. The user will then have to adjust this file manually to his experimental setup.</p>
<p>The only two requirements for this function are:</p>
<ul>
<li>there must be at least one sample file in the folder (however, there should really be more (controls!))</li>
<li>there should not be a <code>SampleInformation.txt</code> in the folder when samples are new</li>
</ul>
<pre><code># This function will generate the empty user targets file for the samples.
saga_gentargets(samplepath)
</code></pre>
</div>
<div id="saga_wrapper" class="section level2">
<h2 class="hasAnchor">
<a href="#saga_wrapper" class="anchor"></a>saga_wrapper</h2>
<p>This function enables the user to perform SAGA analysis in one single step. Only the path to the samples and the SampleInformation.txt file must be provided in the folder. Further, the option <code>doGESEA</code> (defaul setting is 0) gives control over GESEA analysis. In order to perform GESEA analysis, the <code>SampleInformation.txt</code> file has certain requirements which are shown above. One disadvantage of this wrapper function is that the user will loose some flexibility.</p>
<p>The results of GESEA will be generated as separate PDF and results textfiles in the sample folder.</p>
<pre><code># This function performs SAGA analysis in one step.
mySAGAres &lt;- saga_wrapper(samplepath, showModel=0, doGESEA=1)
</code></pre>
</div>
<div id="saga_import" class="section level2">
<h2 class="hasAnchor">
<a href="#saga_import" class="anchor"></a>saga_import</h2>
<p>The <code>saga_import</code> function imports multiple single microarray data files (*.txt format). The user must specify a sample path in the <code>samplepath</code> object to guide the function to the query data. However, the folder should not contain any other files except the <code>SampleInformation.txt</code> file wich can be generated with the <code>saga_gentargets</code> function.</p>
<p>The argument <code>showjoint</code> can be used for quick data visualization. A boxplot will show the joint data set after appending the user samples to the SAGA data set (default value for <code>showjoint</code> is 0).</p>
<pre><code># This will load the default data.
saga_import(samplepath, showjoint=0)
</code></pre>
<p><strong>Please note: </strong> <code>saga_import</code> relies on Agilent raw data in *.txt format. There is no need to process the readout files prior to SAGA analysis.</p>
</div>
<div id="saga_norm" class="section level2">
<h2 class="hasAnchor">
<a href="#saga_norm" class="anchor"></a>saga_norm</h2>
<p>We use quantile normalization as a preprocessing step piror to analysis. The sample arrays are always normalized together with the SAGA data set. This means that training and testing data are merged during the normalization process and will again be separated later for further analysis. This ensures that data are haromonized and no artificial normalization bias enters the analysis. The <code>normplot</code> option also gives control over a boxplot showing the normalized values of the joint data set (the default argument is 0).</p>
<p>In case of multiple probes per array the intensities are averaged to a single value. Agilent readouts usually offer four technical probe replicates and a variety of controls. In the end, 39428 normalized and averaged probes will remain and internal controls are filtered.</p>
<p>Use the plotnumber argument to show either the normalized data in a boxplot (=1) or a t-SNE (=2) plot of the first two dimensions of the combined data sets.</p>
<pre><code># This function applies quantile normalization on the whole data set.
saga_norm(SAGA_RAW, TEST_RAW, pData.joint, plotnumber=2)
</code></pre>
</div>
<div id="saga_batch" class="section level2">
<h2 class="hasAnchor">
<a href="#saga_batch" class="anchor"></a>saga_batch</h2>
<p>Usually microarrays are done in batches. A plethora of external influences may (occasionally) distort otherwise equal arrays beyond recognizability. This often leads to false conclusions when not handled correctly, e.g., wrong clustering results.</p>
<p>In order to avoid such errors we apply batch correction on the joint data set. The user may define his own batches within the <code>SampleInformation.txt</code> file and is required to update the batch information <strong>manually</strong>.</p>
<p>The function requires the rawdata as well as the quantile normalized data from the <code>saga_norm</code> function. Use the plotnumber argument to show either PCA (=1) or t-SNE (=2) plots of the combined data sets.</p>
<pre><code># This function will do the batch correction.
saga_batch(matrix.SAGA.qn, rawdata, plotnumber=2)
</code></pre>
</div>
<div id="saga_sampling" class="section level2">
<h2 class="hasAnchor">
<a href="#saga_sampling" class="anchor"></a>saga_sampling</h2>
<p>This function will take care of the sample preparation of the joint SAGA data set. It will take the batch corrected data from <code>saga_batch</code> and will use the top 9 list of SAGA classifier probes to further filter the whole data set. Then, the joint data set will be separated into a training (SAGA data) and a test set (user samples).</p>
<p>The <code>showSagaModel</code> object gives control over a Principal Components Analysis (PCA) plot showing the first principal components of the model data. Also, the axes show the percentage of explained variance (in %) for the plotted principal components.</p>
<p><span style="color:red"><strong>Red</strong></span> dots are potentially dangerous (transforming) samples and the rest are coding for other SAGA assays that are nontransforming.</p>
<pre><code># This function will do the sampling as a preparation for later classification.
saga_sampling(matrix.SAGA, matrix.test, index, showSagaModel=1)
</code></pre>
<p>The function needs the batch corrected model, test and index data (<code>matrix.SAGA</code> and <code>matrix.test</code>, <code>index</code>). The <code>showPCA</code> argument will give control over the PCA plot (default object value is 0).</p>
<p>The function output offers a training matrix, labels for the training matrix as well as a matrix with the unknown sample data. These matrices are required for the classification and prediction step of the <code>saga_predict</code> function.</p>
<p><strong>Please note: </strong> The PCA plot is not directly qualified for classification decisions. Although it will give a qualitative overview on the global “positions” of the sample data within the SAGA data context, spatial neighborhood in PCA is not a reliable classifier. There are better ways of assessing classification success than optical similarity in a PCA plot. However, rather often, ambigous data will lie in the zone between transforming and nontransforming arrays.</p>
</div>
<div id="saga_predict" class="section level2">
<h2 class="hasAnchor">
<a href="#saga_predict" class="anchor"></a>saga_predict</h2>
<p>For vector safety prediction a Support Vector Machine (SVM) with “radial” kernel is used for building the model. We optimized the cost and gamma factors using the SAGA data and generalize these settings for new and untrained samples.</p>
<p>In a second step, the processed user sample data are predicted using the SVM model. The output shows each sample array along with its SVM probability and a label with <strong>transforming/nontransforming</strong> information - whereas transforming indicates potential danger and nontransforming potential safety of the sample. The probability value can be used as a quality indicator on how clearly the decicion of the SVM was for each sample (the cutoff value is 50%, or &gt;0.5 = transforming).</p>
<pre><code># This function will take care of the model building and prediction steps.
saga_predict(matrix.train, labels.train, matrix.unknown,
                               pData.Test, path=samplepath, writeFile=1, showRoc=0)
</code></pre>
</div>
<div id="saga_gesea" class="section level2">
<h2 class="hasAnchor">
<a href="#saga_gesea" class="anchor"></a>saga_gesea</h2>
<p>For GSEA, we use a gene set of 20 features to predict the genotoxic potential of a vector. The output of GSEA on the microarray data is a normalized enrichment score (NES). For cells transduced with mutagenic vectors like the positive control LTR.RV.SF (gammaretroviral vector with strong promoter/enhancer elements), we observed NES values above 2. We interpret such a result as a strong enrichment and the risk level of a new test vector as likely genotoxic. Vectors eliciting partial deregulation yielded NES values between 0.9 and 2. We interpret this as a weak enrichment and the risk level of a new test vector as potentially genotoxic. NES values below 0.9 were mainly observed for samples transduced with a safe vector configuration (self-inactivating design and weaker promoter). We describe this as no enrichment of our SAGA core set and the risk level of a new test vector as potentially safe. As cutoffs we determined the following thresholds which will be indicated in the GESEA results output.</p>
<ul>
<li>NES &gt;= 2: strong enrichment (likely genotoxic)</li>
<li>NES from 0.9 to 2: weak enrichment (potentially genotoxic)</li>
<li>NES &lt; 0.9 no enrichment (potentially safe).</li>
</ul>
<pre><code># This function will perform Gene Set Enrichtment Analysis (GESEA).
saga_gesea(samplepath, saveResults=1)
</code></pre>
</div>
</div>
<div id="example-analysis-array-prediction" class="section level1">
<h1 class="hasAnchor">
<a href="#example-analysis-array-prediction" class="anchor"></a>Example Analysis &amp; Array Prediction</h1>
<p>This example assumes that 6 arrays (5741, 5746, 5747, 9910, 9914, 9917) are placed in a sample folder. The table above shows the corresponding <code>SampleInformation.txt</code>.</p>
<pre><code>library(saga)
library(sagadata)

samplepath     &lt;- "path to somewhere useful"

### saga_gentargets; automatically generates an empty (!) sample information file
# Modify manually according to your requirements
#targets        &lt;- saga_gentargets(samplepath)

################################################################################
### Wrapper function - all in one
### to use: uncomment function &amp; execute
################################################################################
mySAGAres      &lt;- saga_wrapper(samplepath, showModel=0, doGESEA=1)


################################################################################
### Or use these single functions
################################################################################
### saga_import
rawdata        &lt;- saga_import(samplepath, showjoint=1)
SAGA_RAW       &lt;- rawdata$SAGA_RAW
TEST_RAW       &lt;- rawdata$TEST_RAW
pData.joint    &lt;- rawdata$pData.joint
pData.Test     &lt;- rawdata$pData.Test

### normalize saga data (plotnumber=1 for normalized boxplot, 2 for tSNE plot)
normalized     &lt;- saga_norm(SAGA_RAW, TEST_RAW, pData.joint, plotnumber=1)
qunorm.SAGA    &lt;- normalized$qunorm.SAGA
matrix.SAGA.qn &lt;- normalized$matrix.SAGA.qn
matrix.test.qn &lt;- normalized$matrix.test.qn

### remove batch effects
# plotnumber = 1 (tSNE of first 2 dimensions)
# plotnumber = 2 (PCA of first 2 dimensions)
batchnorm      &lt;- saga_batch(matrix.SAGA.qn, matrix.test.qn, rawdata, pData.joint, plotnumber=1)
index          &lt;- batchnorm$index
matrix.SAGA    &lt;- batchnorm$matrix.SAGA
matrix.test    &lt;- batchnorm$matrix.test

### Sampling and model data collection
model          &lt;- saga_sampling(matrix.SAGA, matrix.test)
matrix.train   &lt;- model$matrix.train
labels.train   &lt;- model$labels.train
matrix.unknown &lt;- model$matrix.unknown

### Array predictions with optimized SVM parameters (default settings)
output         &lt;- saga_predict(samplepath, matrix.train, labels.train, matrix.unknown,
                               pData.Test, writeFile=1, showRoc=0)
classes        &lt;- output$predictions
classes

### GESEA
gesea_results  &lt;- saga_gesea(samplepath, saveResults=1)
</code></pre>
</div>
<div id="references" class="section level1">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<p>[1] R Core Team (2017). R: A language and environment for statistical computing. R Foundation for Statistical Computing, Vienna, Austria. URL <a href="https://www.R-project.org/" class="uri">https://www.R-project.org/</a>.</p>
<p>[2] Orchestrating high-throughput genomic analysis with Bioconductor. W. Huber, V.J. Carey, R. Gentleman, …, M. Morgan Nature Methods, 2015:12, 115.</p>
<p>[3] Gautier, L., Cope, L., Bolstad, B. M., and Irizarry, R. A. 2004. affy—analysis of Affymetrix GeneChip data at the probe level. Bioinformatics 20, 3 (Feb. 2004), 307-315.</p>
<p>[4] Bolstad, BM (2004) Low Level Analysis of High-density Oligonucleotide Array Data: Background, Normalization and Summarization. Dissertation. University of California, Berkeley.</p>
<p>[5] Evarist Planet (2018). phenoTest: Tools to test association between gene expression and phenotype in a way that is efficient, structured, fast and scalable. We also provide tools to do GSEA (Gene set enrichment analysis) and copy number variation.. R package version 1.30.0.</p>
<p>[6] Ritchie, M.E., Phipson, B., Wu, D., Hu, Y., Law, C.W., Shi, W., and Smyth, G.K. (2015). limma powers differential expression analyses for RNA-sequencing and microarray studies. Nucleic Acids Research 43(7), e47.</p>
<p>[7] Jeffrey T. Leek, W. Evan Johnson, Hilary S. Parker, Elana J. Fertig, Andrew E. Jaffe, John D. Storey, Yuqing Zhang and Leonardo Collado Torres (2017). sva: Surrogate Variable Analysis. R package version 3.24.4.</p>
<p>[8] Max Kuhn. Contributions from Jed Wing, Steve Weston, Andre Williams, Chris Keefer, Allan Engelhardt, Tony Cooper, Zachary Mayer, Brenton Kenkel, the R Core Team, Michael Benesty, Reynald Lescarbeau, Andrew Ziem, Luca Scrucca, Yuan Tang, Can Candan and Tyler Hunt. (2018). caret: Classification and Regression Training.</p>
<p>[9] Evarist Planet (2013). phenoTest: Tools to test association between gene expression and phenotype in a way that is efficient, structured, fast and scalable. We also provide tools to do GSEA (Gene set enrichment analysis) and copy number variation.. R package version 1.24.0.</p>
<p>[10] Baptiste Auguie (2017). gridExtra: Miscellaneous Functions for “Grid” Graphics. R package version 2.3.</p>
<p>[11] Hornung, R., Boulesteix, A.-L., Causeur, D. (2016) Combining location-and-scale batch effect adjustment with data cleaning by latent factor adjustment. BMC Bioinformatics 17:27.</p>
<p>[12] John Verzani (2018). UsingR: Data Sets, Etc. for the Text “Using R for Introductory Statistics”, Second Edition. R package version 2.0-6.</p>
<p>[13] Xavier Robin, Natacha Turck, Alexandre Hainard, Natalia Tiberti, Frédérique Lisacek, Jean-Charles Sanchez and Markus Müller (2011). pROC: an open-source package for R and S+ to analyze and compare ROC curves. BMC Bioinformatics, 12, p. 77. DOI: 10.1186/1471-2105-12-77</p>
<p>[14] L.J.P. van der Maaten and G.E. Hinton. Visualizing High-Dimensional Data Using t-SNE. Journal of Machine Learning Research 9(Nov):2579-2605, 2008.</p>
<p>[15] L.J.P. van der Maaten. Accelerating t-SNE using Tree-Based Algorithms. Journal of Machine Learning Research 15(Oct):3221-3245, 2014.</p>
<p>[16] Jesse H. Krijthe (2015). Rtsne: T-Distributed Stochastic Neighbor Embedding using a Barnes-Hut Implementation, URL: <a href="https://github.com/jkrijthe/Rtsne" class="uri">https://github.com/jkrijthe/Rtsne</a>.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#about-saga-package">About SAGA package</a></li>
      <li>
<a href="#package-requirements">Package Requirements</a><ul class="nav nav-pills nav-stacked">
<li><a href="#saga-package-installation">SAGA Package installation</a></li>
      </ul>
</li>
      <li><a href="#introduction">Introduction</a></li>
      <li><a href="#basic-requirements">Basic requirements</a></li>
      <li><a href="#data-structure">Data structure</a></li>
      <li>
<a href="#using-the-functions-of-the-saga-package">Using the functions of the SAGA package</a><ul class="nav nav-pills nav-stacked">
<li><a href="#saga_gentargets">saga_gentargets</a></li>
      <li><a href="#saga_wrapper">saga_wrapper</a></li>
      <li><a href="#saga_import">saga_import</a></li>
      <li><a href="#saga_norm">saga_norm</a></li>
      <li><a href="#saga_batch">saga_batch</a></li>
      <li><a href="#saga_sampling">saga_sampling</a></li>
      <li><a href="#saga_predict">saga_predict</a></li>
      <li><a href="#saga_gesea">saga_gesea</a></li>
      </ul>
</li>
      <li><a href="#example-analysis-array-prediction">Example Analysis &amp; Array Prediction</a></li>
      <li><a href="#references">References</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Steven Talbot, Adrian Schwarzer, Rothe Michael.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
